<!DOCTYPE html>
<html>
  <head>
    <title>Portanoia Retro</title>
    <meta charset="utf-8">
<link rel="icon" href="/favicon.ico" type="image/x-icon" />
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="stylesheet" href="/assets/css/main.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/dark.min.css">
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/go.min.js"></script>
  </head>
  <body>
    <nav>
    <div class="navbar">
      <div class="nav-container">
        <input
          class="checkbox"
          type="checkbox"
          name=""
          id="" />
        <div class="hamburger-lines">
          <span class="line line1"></span>
          <span class="line line2"></span>
          <span class="line line3"></span>
        </div>
        <div class="logo">
          <a href="/"><h1>DEV. HACKER. WEIRDO.</h1></a>
        </div>
        <div class="menu-items">
          <li>
            <a href="/">HOME</a>
          </li>
          <li>
            <a href="/projects">PROJECTS</a>
          </li>
          <li>
            <a href="/resume.pdf">RESUME</a>
          </li>
          <li>
            <a href="https://github.com/0x4445565a" target="_blank" rel="nofollow">GITHUB</a>
          </li>
          <li>
            <a href="https://www.codewars.com/users/0x4445565A" target="_blank" rel="nofollow">CODEWARS</a>
          </li>
          <li>
            <a href="#">LINKEDIN</a>
          </li>
        </div>
      </div>
    </div>
  </nav>
    <main>
    <div id="editor">
      <div class="editor-header">
        <div class="editor-ui">
          <div class="ui-button close"></div>
          <div class="ui-button minimize" id="minimize-button"></div>
          <div class="ui-button maximize" id="maximize-button"></div>
        </div>
        ~/About.json
      </div>
      <div class="editor-body">
        <pre>
# A quick rundown of current information
{
  about: """
  I'm Brandon Martinez a Sr. software engineer who specializes in ETL pipelines, system tools, and highly availiblty services.  My favorite projects usually involve creating tools for other developers.  I have a passion for low level tech and efficiency.
  """,
  resume: "RESUME_LINK",
  contact: [
    "brandon@ibreak.systems"
  ],
  strong_skills: [
    "golang",
    "python",
    "linux",
    "bash",
    "offensive security"
  ],
  learning: [
    "rust",
  ],
  minor_skills: [
    "electronics engineering",
    "fusion 360",
    "3D Printing/CNC"
  ]
}
        </pre>
        <div class="editor-scroll">
          <div class="editor-scroll-scrub"></div>
        </div>
      </div>
      <div class="editor-footer"></div>
    </div>
  </main>
    <div class="post-content">
      <div class="content">
        <h1>// Portanoia Retrospective</h1>
<p>In late 2016 I was experimenting with creating defensive security tools and I had a big interest in working with raw packets.  As a result I dreamt up the concept for <a href="https://github.com/0x4445565A/portanoia">portanoia</a>, originally it was written in python but for the learning experience I recreated a more robust version in go.</p>
<p>The idea behind the project is simple.  Create a port and if the port gets any traffic report the connection to the user so an action can be taken.  The most common action being to push the <code>src</code> IP into iptables and block it.  The project itself was written haphazardly over the course of a week.  It was an arms race against myself.  I wrote the honeypot port.  Then I would scan it, watch it work, and keep changing <a href="https://nmap.org/">nmap</a> flags until my honeypot couldn't detect the scan but the scan.</p>
<p>I learned a lot about raw packets, go routines, TCP/UDP raw sockets, and nmap.  Originally it was just a normal TCP socket, but pretty quickly I realized with scans like <a href="https://nmap.org/book/scan-methods-null-fin-xmas-scan.html">TCP FIN, NULL, and Xmas</a> that my tool can be bypassed.  Nmap essentially half connects to a port just long enough in the handshake to see a connection start, but then it quickly aborts.  Golang's <a href="https://pkg.go.dev/net#TCPConn">TCP socket</a> requires a full connection to be established before the connection is made available to the software.  To get around this I implement go's wonderful raw socket module.</p>
<p>By the end of the week it was very difficult to get my hyper sensitive <a href="https://github.com/0x4445565A/portanoia">portanoia</a> program to not respond to any packet meant for my service.  Overall a pretty solid success.</p>
<img src="/assets/posts/portanoia-usage.png">
<h2>Did It Work?</h2>
<p>It actual work really well, still does, and it's pretty fast too.  However, I don't know if I agree with how I implemented threading.  I didn't do enough testing to make sure the raw packet returning packets back out of order wouldn't cause network issues for the device, honestly a naive consideration I didn't even make.  I just wanted to go fast.</p>
<p>There was one major vulnerability though.  In theory the attacker could use <a href="https://nmap.org/book/man-bypass-firewalls-ids.html">nmaps IP spoofing</a> to change the IP to something that would make your computer block or counter attack an IP address that isn't the actual attacker.  Of course the attacker would need to know you're running <a href="https://github.com/0x4445565A/portanoia">portanoia</a>, but obscurity isn't a valid excuse.</p>
<h2>What Would I Change?</h2>
<p>Honestly its a solid attempt for a CLI tool.  I would make a better separation of concerns UI module, packet handler, go routine manager, etc.  It's currently all in one file and I would much prefer that I made a library and then a frontend for it.  This would make it easier to maintain/change parts out.  This is a practice I do more often but I did not consider in 2016.</p>
<p>Additionally, I would also have better built in support for the action response.  Maybe running modules that can validate the source address, or at the very least make sure the action wont be taken against yourself or the router.</p>
<h2>Retrospective</h2>
<p>Overall I am fairly pleased with the project.  If I were to rewrite it I would organize better, validate the source IP, and make it easier to maintain.  A very solid project to revisit.</p>

      </div>
      <div class="side-bar">
        <h3>More Projects</h3>
        <ul>
        
          
            <li><a href="/projects/2023/yabfi">Rust BF Interpreter</a></li>
          
        
          
            <li><a href="/projects/2023/compression">Compression Tool</a></li>
          
        
          
            <li><a href="/projects/2023/from-go-to-rust">From Go to Rust</a></li>
          
        
          
            <li><a href="/projects/2023/portanoia">Portanoia Retro</a></li>
          
        
          
            <li><a href="/projects/2023/sushi-phish">Sushi Phish Tool Retro</a></li>
          
        
          
            <li><a href="/projects/2023/static-site">Custom CMS vs Static Site</a></li>
          
        
          
        
      </ul>
      </div>
    </div>
    <footer>
    <div>
      <h2>PROGRAMMING</h2>
      <ul>
        <li><a href="https://github.com/0x4445565a" target="_blank" rel="nofollow">GITHUB</a></li>
        <li><a href="https://www.codewars.com/users/0x4445565A" target="_blank" rel="nofollow">CODEWARS</a></li>
      </ul>
    </div>
    <div>
      <h2>EXTERNAL PROJECTS</h2>
      <ul>
        <li><a href="https://foursuits.co/roguesvillage" target="_blank" rel="nofollow">Rogues Village @ DEFCON</a></li>
      </ul>
    </div>
    <div>
      <h2>DOES ANYONE</h2>
      <ul>
        <li>Actually</li>
        <li>Ever Read</li>
        <li>The Footer</li>
      </ul>
    </div>
  </footer>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.4.2/jquery.min.js"></script>
<script src="/assets/js/jquery.raptorize.1.0.js"></script>
<script>
  document.addEventListener('DOMContentLoaded', (event) => {
    document.querySelectorAll('pre').forEach((el) => {
      hljs.highlightElement(el);
    });

    var x = document.getElementById("editor");
    x.querySelector(".editor-body pre").innerHTML = x.querySelector(".editor-body pre").innerHTML.replace("RESUME_LINK", "<a href=/resume.pdf target=_blank>resume.pdf</a>");

    let minElement = document.getElementById("minimize-button");
    minElement.addEventListener("click", function() {
      document.getElementById("editor").classList.toggle("minimize");
    });
    let maxElement = document.getElementById("maximize-button");
    maxElement.addEventListener("click", function() {
      document.getElementById("editor").classList.toggle("minimize");
    });
    $('.editor-header .editor-ui .close').raptorize();
  });
</script>
<script src="/assets/js/navigation.js"></script>
    <script>
      document.addEventListener('DOMContentLoaded', (event) => {
        document.getElementById("editor").classList.toggle("minimize");
      });
    </script>
  </body>
</html>