<!DOCTYPE html>
<html>
  <head>
    <title>Rust BF Interpreter</title>
    <meta charset="utf-8">
<link rel="icon" href="/favicon.ico" type="image/x-icon" />
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="stylesheet" href="/assets/css/main.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/dark.min.css">
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/go.min.js"></script>
  </head>
  <body>
    <nav>
    <div class="navbar">
      <div class="nav-container">
        <input
          class="checkbox"
          type="checkbox"
          name=""
          id="" />
        <div class="hamburger-lines">
          <span class="line line1"></span>
          <span class="line line2"></span>
          <span class="line line3"></span>
        </div>
        <div class="logo">
          <a href="/"><h1>DEV. HACKER. WEIRDO.</h1></a>
        </div>
        <div class="menu-items">
          <li>
            <a href="/">HOME</a>
          </li>
          <li>
            <a href="/projects">PROJECTS</a>
          </li>
          <li>
            <a href="/resume.pdf">RESUME</a>
          </li>
          <li>
            <a href="https://github.com/0x4445565a" target="_blank" rel="nofollow">GITHUB</a>
          </li>
          <li>
            <a href="https://www.codewars.com/users/0x4445565A" target="_blank" rel="nofollow">CODEWARS</a>
          </li>
          <li>
            <a href="#">LINKEDIN</a>
          </li>
        </div>
      </div>
    </div>
  </nav>
    <main>
    <div id="editor">
      <div class="editor-header">
        <div class="editor-ui">
          <div class="ui-button close"></div>
          <div class="ui-button minimize" id="minimize-button"></div>
          <div class="ui-button maximize" id="maximize-button"></div>
        </div>
        ~/About.json
      </div>
      <div class="editor-body">
        <pre>
# A quick rundown of current information
{
  about: """
  I'm Brandon Martinez a Sr. software engineer who specializes in ETL pipelines, system tools, and highly availiblty services.  My favorite projects usually involve creating tools for other developers.  I have a passion for low level tech and efficiency.
  """,
  resume: "RESUME_LINK",
  contact: [
    "brandon@ibreak.systems"
  ],
  strong_skills: [
    "golang",
    "python",
    "linux",
    "bash",
    "offensive security"
  ],
  learning: [
    "rust",
  ],
  minor_skills: [
    "electronics engineering",
    "fusion 360",
    "3D Printing/CNC"
  ]
}
        </pre>
        <div class="editor-scroll">
          <div class="editor-scroll-scrub"></div>
        </div>
      </div>
      <div class="editor-footer"></div>
    </div>
  </main>
    <div class="post-content">
      <div class="content">
        <h1>Yet Another Brain F*ck Interpreter</h1>
<p>-- See project <a href="https://github.com/0x4445565A/yabfi" target="_blank" rel="noopener noreferrer nofollow">here</a></p>
<img src="/assets/posts/yabfi-hello-world.png">
<h2>What is BF</h2>
<p>Brain F*ck, also known as BF and brain-lang, is an esoteric programming language.  If you are unfamiliar <a href="https://www.youtube.com/watch?v=hdHjjBS4cs8" target="_blank" rel="noopener noreferrer nofollow">this video</a> is a great primer. Its syntax is so simple, with only 8 symbols <code>+-[].,&gt;&lt;</code>, but in its simplicity it becomes almost unusable.  At its core BF has a static sized buffer.  This buffer stores a byte, initialized with 0.  To interact with the buffer you use <code>+-</code> to increment and decrement the buffer at the current pointer. <code>&gt;&lt;</code> shifts the pointer to the right and left. <code>.</code> prints the current value at the pointer as an ascii character. <code>,</code> requests a number from STDIN and places it in the pointer position.</p>
<h2>What is YABFI</h2>
<p>Yet Another Brain F*ck Interpreter is just another interpreter for BF, written in Rust.  While the world didn't need ANOTHER Rust powered BFI, I really wanted to write one.  I figured since I'm still learning Rust it would make for another awesome project.</p>
<h2>Constraints</h2>
<p>As will all of my projects I started with constraints and project steps.  The constraints were as follows..</p>
<ul>
<li>Accepts common BF code and print the expected result</li>
<li>Accepts BF code from STDIN</li>
<li>Accepts BF code in an python CLI like environment</li>
<li>Has extra features to make the CLI interpreter environment easier to use</li>
</ul>
<h2>Challenges</h2>
<p>Ultimately this project went by super smoothly.  Brain-lang is very well documented, however I avoided looking at anyone's code so I could keep the challenge.</p>
<p>The first issue I ran into was supporting wrap around addition and subtraction.  In BF if I execute <code>0-1</code> it should return 255, which does not play well with Rust's <code>u8</code> type, it immediately throws an overflow error.  So I considered switching to <code>i16</code> to abuse the signed bit, but there were many issues with this and the Rust compile caught me out.  After digging through the Rust docs I found <code>wrapping_add()</code> (<a href="https://doc.rust-lang.org/std/primitive.u8.html#method.wrapping_add" target="_blank" rel="noopener noreferrer nofollow">Read more here</a>).  This allows me to do that math but ignore the carrying digit.  Additionally the <code>wrapping_sub()</code> does the same for me going in the opposite direction.</p>
<p>The final challenge was figuring out how to handle the loops.  BF Loops are pretty simple.  When you encounter a <code>[</code> if the current pointer value is <code>0</code> you skip to the matching <code>]</code>.  When you encounter a <code>]</code> you jump back to the matching <code>[</code>.  The way I handled this was actually pretty simple.</p>
<p>I do this with a single <code>Vec&lt;usize&gt;</code>.  All I do it I <code>push()</code> the program cursor position to the stack when I see a <code>[</code>.  When I see a <code>]</code> I <code>pop()</code> the loop stack and store that.  If the <code>buf[pointer]</code> value is <code>0</code> I move forward exiting the loop otherwise I skip the cursor back the popped value.  The stack of course is so I can have multiple nested loops and keep track of them all.</p>
<pre style="background-color:#2b303b;">
<code><span style="color:#c0c5ce;">match program[cursor] as char {
</span><span style="color:#c0c5ce;">  // -- snip --
</span><span style="color:#c0c5ce;">  &#39;[&#39; =&gt; stack.push(cursor),
</span><span style="color:#c0c5ce;">  &#39;]&#39; =&gt; {
</span><span style="color:#c0c5ce;">      let start = stack.pop().unwrap();
</span><span style="color:#c0c5ce;">      // Set the cursor back to the start of the loop
</span><span style="color:#c0c5ce;">      if arr[p] != 0 {
</span><span style="color:#c0c5ce;">          cursor = start;
</span><span style="color:#c0c5ce;">          continue;
</span><span style="color:#c0c5ce;">      }
</span><span style="color:#c0c5ce;">  }
</span><span style="color:#c0c5ce;">}
</span></code></pre>
<h2>Conclusion</h2>
<p>YABFI is a silly little program that was written in about 3 hours.  I had a lot of fun writing it and was given an opportunity to dive into Rust's primitive type methods.  I think the idea of creating a Brain-lang CLI interpreter with a consistent buffer is fairly novel.  10/10 would write again.</p>
<img src="/assets/posts/yabfi.png">
      </div>
      <div class="side-bar">
        <h3>More Projects</h3>
        <ul>
        
          
            <li><a href="/projects/2023/yabfi">Rust BF Interpreter</a></li>
          
        
          
            <li><a href="/projects/2023/compression">Compression Tool</a></li>
          
        
          
            <li><a href="/projects/2023/from-go-to-rust">From Go to Rust</a></li>
          
        
          
            <li><a href="/projects/2023/portanoia">Portanoia Retro</a></li>
          
        
          
            <li><a href="/projects/2023/sushi-phish">Sushi Phish Tool Retro</a></li>
          
        
          
            <li><a href="/projects/2023/static-site">Custom CMS vs Static Site</a></li>
          
        
          
        
      </ul>
      </div>
    </div>
    <footer>
    <div>
      <h2>PROGRAMMING</h2>
      <ul>
        <li><a href="https://github.com/0x4445565a" target="_blank" rel="nofollow">GITHUB</a></li>
        <li><a href="https://www.codewars.com/users/0x4445565A" target="_blank" rel="nofollow">CODEWARS</a></li>
      </ul>
    </div>
    <div>
      <h2>EXTERNAL PROJECTS</h2>
      <ul>
        <li><a href="https://foursuits.co/roguesvillage" target="_blank" rel="nofollow">Rogues Village @ DEFCON</a></li>
      </ul>
    </div>
    <div>
      <h2>DOES ANYONE</h2>
      <ul>
        <li>Actually</li>
        <li>Ever Read</li>
        <li>The Footer</li>
      </ul>
    </div>
  </footer>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.4.2/jquery.min.js"></script>
<script src="/assets/js/jquery.raptorize.1.0.js"></script>
<script>
  document.addEventListener('DOMContentLoaded', (event) => {
    document.querySelectorAll('pre').forEach((el) => {
      hljs.highlightElement(el);
    });

    var x = document.getElementById("editor");
    x.querySelector(".editor-body pre").innerHTML = x.querySelector(".editor-body pre").innerHTML.replace("RESUME_LINK", "<a href=/resume.pdf target=_blank>resume.pdf</a>");

    let minElement = document.getElementById("minimize-button");
    minElement.addEventListener("click", function() {
      document.getElementById("editor").classList.toggle("minimize");
    });
    let maxElement = document.getElementById("maximize-button");
    maxElement.addEventListener("click", function() {
      document.getElementById("editor").classList.toggle("minimize");
    });
    $('.editor-header .editor-ui .close').raptorize();
  });
</script>
<script src="/assets/js/navigation.js"></script>
    <script>
      document.addEventListener('DOMContentLoaded', (event) => {
        document.getElementById("editor").classList.toggle("minimize");
      });
    </script>
  </body>
</html>