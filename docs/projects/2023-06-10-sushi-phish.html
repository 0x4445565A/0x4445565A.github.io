<!DOCTYPE html>
<html>
  <head>
    <title>Sushi Phish Tool Retro</title>
    <meta charset="utf-8">
<link rel="icon" href="/favicon.ico" type="image/x-icon" />
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="stylesheet" href="/assets/css/main.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/dark.min.css">
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/go.min.js"></script>
  </head>
  <body>
    <nav>
    <div class="navbar">
      <div class="nav-container">
        <input
          class="checkbox"
          type="checkbox"
          name=""
          id="" />
        <div class="hamburger-lines">
          <span class="line line1"></span>
          <span class="line line2"></span>
          <span class="line line3"></span>
        </div>
        <div class="logo">
          <a href="/"><h1>Brandon @ iBreak.Systems</h1></a>
        </div>
        <div class="menu-items">
          <li>
            <a href="/">HOME</a>
          </li>
          <li>
            <a href="/projects">PROJECTS</a>
          </li>
          <li>
            <a href="/resume.pdf">RESUME</a>
          </li>
          <li>
            <a href="https://github.com/0x4445565a" target="_blank" rel="nofollow">GITHUB</a>
          </li>
          <li>
            <a href="https://www.codewars.com/users/0x4445565A" target="_blank" rel="nofollow">CODEWARS</a>
          </li>
          <li>
            <a href="#">LINKEDIN</a>
          </li>
        </div>
      </div>
    </div>
  </nav>
    <main>
    <div id="editor">
      <div class="editor-header">
        <div class="editor-ui">
          <div class="ui-button close"></div>
          <div class="ui-button minimize" id="minimize-button"></div>
          <div class="ui-button maximize" id="maximize-button"></div>
        </div>
        ~/About.json
      </div>
      <div class="editor-body">
        <pre>
# A quick rundown of current information
{
  about: """
  I'm Brandon Martinez a Sr. software engineer who specializes in ETL pipelines, system tools, and high availiblty services.  My favorite projects usually involve creating tools for other developers.  I have a passion for low level tech and efficiency.
  """,
  resume: "RESUME_LINK",
  contact: [
    "brandon@ibreak.systems"
  ],
  strong_skills: [
    "golang",
    "rust",
    "python",
    "linux",
    "bash",
    "offensive security"
  ],
  minor_skills: [
    "electronics engineering",
    "fusion 360"
  ]
}
        </pre>
        <div class="editor-scroll">
          <div class="editor-scroll-scrub"></div>
        </div>
      </div>
      <div class="editor-footer"></div>
    </div>
  </main>
    <div class="post-content">
      <div class="content">
        <h1>Sushi Phish Scrapper</h1>
<p>In 2016 a security research known as ExecuteMalware documented their process on how they discover new phishing domains.  That old blog post can be read <a href="https://web.archive.org/web/20170822061820/http://executemalware.com/?p=258">here</a>.  The short of it is you can download a snapshot of the recently registered domain names from a service like <a href="https://dnpedia.com/tlds/daily.php">dnpedia</a> and from there you can parse out domains of suspicious keywords.</p>
<p>At this time I was in the early stages of learning Go, so I decided to write a quick program that lets me ingest these domains and search for hot keywords.  In retrospec that program is far from efficient and there are many things I would do differently.  However I am more interested in documenting the historical aspects of this project as different parts get lost to time.</p>
<p>The project can still be viewed on <a href="https://github.com/0x4445565A/sushiphish">github.com/0x4445565A/sushiphish</a>
<img src="/assets/posts/sushi-usage.png"></p>
<h2>Why it's bad</h2>
<p>Looking at the code itself for a learning project it isn't too egregious(I'm being kind to past Brandon), however it fails to meets the goals of the tool.</p>
<h3>Missing Headless Mode</h3>
<p>I set out to create a tool that ideally would have mix modes, a headless quiet mode and an interactive mode.  Looking out how I structured the arguments its very clear the headless mode is not present, which is arguably the more important feature.  If I am trying to discover 1000s of phishing domains the tool should ideally collect the domains and create an output.  This output should then be able to feed back into the program in a managed mode at a later time.</p>
<pre style="background-color:#2b303b;">
<code><span style="color:#c0c5ce;">// https://github.com/0x4445565A/sushiphish/blob/master/sushiphish.go#LL162C1-L169C27
</span><span style="color:#c0c5ce;">if len(os.Args) &lt; 3 {
</span><span style="color:#c0c5ce;">    fmt.Printf(&quot;Usage: %s input.txt out.csv\n&quot;, os.Args[0])
</span><span style="color:#c0c5ce;">    fmt.Printf(&quot;Optional: %s input.txt out.csv hotword1 hotword2 ... hotwordN\n&quot;, os.Args[0])
</span><span style="color:#c0c5ce;">    return
</span><span style="color:#c0c5ce;">}
</span><span style="color:#c0c5ce;">
</span><span style="color:#c0c5ce;">inputFileName := os.Args[1]
</span><span style="color:#c0c5ce;">csvFileName := os.Args[2]
</span></code></pre>
<h3>No fuzzy matching</h3>
<p>The program has some default arguments that can be passed in.  Things like paypal, apple, amazon, etc but this is not sufficient.  The suspicion check is very naive, it essentially matches <code>*HOTWORD*</code>.  This means people sitting on <a href="https://web.archive.org/web/20180713212603/http://media.blackhat.com/bh-us-11/Dinaburg/BH_US_11_Dinaburg_Bitsquatting_WP.pdf">bitsquatting</a> or domains with similar characters are being left out.</p>
<p>If I were to rewrite this I would want to add regular expression support along side a flag for checking bit flip matches and similar character replacement.  For example in similar characters <code>instagram =&gt; lnstagrarn</code> where <code>l</code> looks like <code>i</code> and <code>r n</code> looks like <code>m</code>.  In bitsquatting <code>instagram =&gt; knstagram</code> because <code>i =&gt; 0b01101001</code> and if the 2nd bit was flipped the <code>i</code> would be a <code>k</code>.  Ideally this would be behind a feature flag and would let non-regex hot words trigger on these mangle rules.</p>
<pre style="background-color:#2b303b;">
<code><span style="color:#c0c5ce;">func isSuspicious(d string) bool {
</span><span style="color:#c0c5ce;">	d = strings.ToLower(d)
</span><span style="color:#c0c5ce;">	for _, h := range hotList {
</span><span style="color:#c0c5ce;">		if strings.Contains(d, h) {
</span><span style="color:#c0c5ce;">			return true
</span><span style="color:#c0c5ce;">		}
</span><span style="color:#c0c5ce;">	}
</span><span style="color:#c0c5ce;">	return false
</span><span style="color:#c0c5ce;">}
</span></code></pre>
<h3>The Rest</h3>
<p>Ultimately the tool is okay, it does a job but it doesn't take advantage of any of the features that make golang so special.  It is no more complex than a bash script.  It would have been nice if it also sourced the CSV, had better documentation for file expectations, and a more cohesive usage banner.</p>
<p>What even is this...</p>
<pre style="background-color:#2b303b;">
<code><span style="color:#c0c5ce;">c = len(checkList)  // Yuck
</span><span style="color:#c0c5ce;">fmt.Printf(&quot;Analysing %d domain(s)...\n&quot;, c)
</span><span style="color:#c0c5ce;">fmt.Println(&quot;Starting manual site inspection...&quot;)
</span><span style="color:#c0c5ce;">for k, v := range checkList {  
</span><span style="color:#c0c5ce;">    checkList = processDomain(k, v, checkList)  // This is the goofiest thing
</span><span style="color:#c0c5ce;">}
</span><span style="color:#c0c5ce;">c = len(checkList)  // Yuck
</span><span style="color:#c0c5ce;">fmt.Printf(&quot;Exporting %d bad domains to CSV...\n&quot;, c)
</span></code></pre>
<h2>Retro</h2>
<p>This tool is bad, but I shouldn't feel bad for that.  It was a small project to learn and explore a language that I eventually launched into a successful career.  I have learned a lot and looking through this project 7 years later is a blast from the past and I'm happy to recognize how much I have grown as an engineer.</p>
<p>To the reader I ask when was the last time you ripped apart an old project?  It could be fun.</p>

      </div>
      <div class="side-bar">
        <h3>More Projects</h3>
        <ul>
        
          
            <li><a href="/projects/2023-06-10-static-site.html">Moved to Cobalt</a></li>
          
        
          
            <li><a href="/projects/2023-06-10-sushi-phish.html">Sushi Phish Tool Retro</a></li>
          
        
          
            <li><a href="/projects/index.html">Brandon @ iBreak.systems:/projects</a></li>
          
        
      </ul>
      </div>
    </div>
    <footer>
    <div>
      <h2>Test</h2>
      <ul>
        <li>test1</li>
        <li>test2</li>
        <li>test3</li>
      </ul>
    </div>
    <div>
      <h2>Test</h2>
      <ul>
        <li>test1</li>
        <li>test2</li>
        <li>test3</li>
      </ul>
    </div>
    <div>
      <h2>Test</h2>
      <ul>
        <li>test1</li>
        <li>test2</li>
        <li>test3</li>
      </ul>
    </div>
  </footer>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.4.2/jquery.min.js"></script>
<script src="/assets/js/jquery.raptorize.1.0.js"></script>
<script>
  document.addEventListener('DOMContentLoaded', (event) => {
    document.querySelectorAll('pre').forEach((el) => {
      hljs.highlightElement(el);
    });

    var x = document.getElementById("editor");
    x.querySelector(".editor-body pre").innerHTML = x.querySelector(".editor-body pre").innerHTML.replace("RESUME_LINK", "<a href=/resume.pdf target=_blank>resume.pdf</a>");

    let minElement = document.getElementById("minimize-button");
    minElement.addEventListener("click", function() {
      document.getElementById("editor").classList.toggle("minimize");
    });
    let maxElement = document.getElementById("maximize-button");
    maxElement.addEventListener("click", function() {
      document.getElementById("editor").classList.toggle("minimize");
    });
    $('.editor-header .editor-ui .close').raptorize();
  });
</script>
<script src="/assets/js/navigation.js"></script>
    <script>
      document.addEventListener('DOMContentLoaded', (event) => {
        document.getElementById("editor").classList.toggle("minimize");
      });
    </script>
  </body>
</html>